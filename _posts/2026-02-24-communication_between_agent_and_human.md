---
layout: post
title: 人机新范式：AI Agent 参与下的软件工程协作与边界探索
date: 2026-02-24 00:10 -0400
lang: zh
ref: communication-between-agent-and-human
slug: communication-between-agent-and-human
permalink: /zh/posts/communication-between-agent-and-human/
tags: [Agent, Huam-AI Collaboration, Agentic Workflow]
---

> 🌐 语言 / Language: [中文](/zh/posts/communication-between-agent-and-human/) | [English](/en/posts/communication-between-agent-and-human/)

AI 算法的快速应用在工程实践中带来了一系列亟待解决的问题。

一方面，对于需要严格遵循行业规范的领域，当前 AI 往往缺失专业数据的支撑、与传统工具链的深度集成以及行业认证机制。另一方面，基于 Transformer 架构的大模型本质上受限于概率性，不仅难以达到工业界 100% 的准确度要求，其“幻觉”也难以被准确探测和控制；同时，有限的上下文窗口（Context Window）不可避免地会导致 Agent 出现“失忆”现象。

因此，为了应对这些垂直与深度应用中的挑战，**我们必须为 Agent 引入“验证器（Validator）”机制。** Agent 输出的代码不能直接流转到生产环境，必须经过基于规则的传统工具链进行强校验。

### 协作环境的剧变：从“人-人”到“人-Agent”

在与企业合作的过程中，我们发现 AI Agent 的引入带来了一种全新的协作环境。从单纯的“人与人”交互，演变成了“人与人”以及“人与 Agent（或 Agent 系统）”的复杂交互。

在传统的非 Agent 开发中，开发者之间存在基本的共识：尽量少地改动他人的环境和代码。各个模块的负责人可以根据预先制定好的、适应人类分工的角色，在后续的调整和追责中快速定位并协调。

然而，当 Agent 参与到开发环境中时，原有的共识被打破了，随之而来的是几个显著的痛点：

1. **缺乏边界感与重构倾向：** Agent 系统定义的 Prompt 通常无法包含所有的开发共识（受限于 Context 长度和系统灵活性）。Agent 在处理长链路任务时容易“顾此失彼”，它倾向于在全局层面进行整体改动和重构，而不是在局部打补丁。这就导致了后续追踪极其困难，代码 Review 成本极高。
2. **缺乏主动沟通与中间态验证：** 在开发过程中，Agent 通常在接到用户需求后，无论信息是否充分都会立即开始工作。中间出现的需求偏差往往直到最后的验收环节才能被发现。Agent 不会像人类一样主动核对需求，也不会主动进行一系列中间过程的阶段性验收。
3. **信息处理的噪声差异：** Agent 处理一段信息时的“重点”往往与人类开发者不同，因此需求对接中存在信息噪声。开发者常误以为只要给了 Prompt，Agent 就会一丝不苟地完成，但由于 Agent 自身的记忆机制、Prompt 设计以及大模型的随机性，其实际表现非常“动态”。

### 人机协同的探索：单人与多人的场景切分

目前人类依然是开发环境中的核心。人的优势在于主体性和创造性思维，是终极需求的提供者，理应由人来界定主次需求与限制。而 Agent 的优势在于海量知识的总结和广度，能够不知疲倦地机械化执行步骤。

针对不同的任务性质与复杂度，我们探索了两种协同场景：

* **场景 1：单人 + Agent。** 适用于需求较单一、更改频率较低的任务。通常由人提出需求，Agent 根据信息和环境反馈按步骤持续执行。在适当的时机（或基于人的判断、任务完成、阶段总结），人根据反馈产生新的需求，持续多轮迭代。在此场景中，人是需求提供者和验收者，主要负责修正 Agent 的效果，较少参与手动开发。
* **场景 2：多人 + Agent。** 适用于需求复杂、频繁对接的协作任务。人类开发者通常有擅长的模块（前端、后端、架构等）并承担相应责任。**矛盾点在于：开发人员有明确的职责边界，而 Agent 没有。** Agent 既可能达不到特定模块的专业要求，又可能暗中破坏其他人的模块。此外，并行开发时还需要解决“Agent 与 Agent 之间信息交流同步”的棘手问题。此时，人类不仅要开发，还承担了“沟通桥梁”的角色，负责拆分需求、处理冲突和模块测试。

### 两种系统级工作流：Module 开发 vs Relay 开发

为了解决上述问题，我们初步梳理出两种协同 Agent 工作流，其核心思路都是**想办法将复杂工作降维成类似“场景 1”的工作流**。

#### 1. 模块化开发 (Module-based Development)
* **模式：** 一个开发人员与相应的 Agent 结对，定义明确的子需求和职责边界。依旧按照各自担任的角色划分工作模块（前后端、架构等），然后再互相协作。
* **特点：** 支持并行开发，需要版本控制辅助。
* **局限与对策：** 依然受限于开发者自身的局限性，无法完全发挥 Agent 的知识广度。这实际上是将 Agent 降级为“高级 Copilot”。为了更好地利用它，**必须引入严格的权限与作用域（Scope）控制**。例如，系统底层应强制限制前端 Agent 只能读取全局接口定义，且仅拥有前端代码目录的修改权限，从物理层面阻止其“越界”。
* **契约建立：** 除了物理级别的隔离之外，既然 Agent 缺乏人类的“社会共识”，我们就必须用代码强制建立共识。例如：
    * **接口先行：** 开发者（或架构师 Entity）首先定义好严格的 API 契约（如 OpenAPI/Swagger 规范）、数据结构或通信协议。
    * **Mock 与桩代码验证：** Agent 在其独立的模块中开发时，系统自动提供基于契约的 Mock 环境。Agent 的工作产出必须通过基于该契约的自动化测试（Validator 机制），才能发起代码合并请求（PR）。

#### 2. 接力式开发 (Relay-based Development)
* **模式：** 同一时间由一个开发人员带着 Agent 运行，按领域由浅入深推进，完成后再迭代升级或交接。
* **特点：** 能充分发挥 Agent 的功能广度。
* **局限与对策：** 不支持并行，且验收范围广，极度依赖单个开发者的全局把控力。此模式**极度依赖上下文管理（Context Management）**。当任务进行“接力”时，必须打包当前阶段的“设计意图、妥协点、未决问题”。这要求 Agent 系统在代码之外，能够自动生成并维护一份动态的**“架构上下文快照（Context Snapshot）”**，以克服模型输入限制导致的“失忆”。
* **状态传递：** 在许多架构中，单纯基于对话历史（Chat History）和事件流（Event Stream）的上下文管理是极其低效的。我们需要引入更高维度的状态传递机制，例如**结构化上下文快照**和**记忆分层检索**，让接手的新 Agent 能迅速理解当前的系统全貌和前置意图。

在实际的工程框架改造中，我们往往会发现，这两种模式并不是非黑即白的。一个高级的系统架构可能会在宏观上采用 Module 隔离不同的业务域，而在微观的单个复杂模块内部，采用 Relay 模式让开发者带领 Agent 纵深突破。

### 迈向理想态：基于 Entity 特性的架构设计

站在更理想的角度，我们不应再纠结于“人与 Agent”的物理分别，而应该走向**“Entity（实体）职责边界的界定”**。

一个理想的软件工程场景，应该是基于不同 Entity 的特性（无论是人类开发者还是 AI Agent）来分配需求、划定环节边界，并流转整个开发验收流程。为了实现这一有机、高效的开发环境，我们需要在工程上落地以下三个机制：

1.  **引入“规划与调度层” (Planning & Orchestration)：** 决不能让执行态的 Agent 直接对接模糊需求。在 Entity 协作网络中，必须存在专门负责“需求反问、任务拆解、边界定义”的节点（可以是资深开发者，也可以是专属的 Planning Agent）。它不写代码，只负责将宏观需求翻译成带有严格“验收标准（Acceptance Criteria）”和“影响范围（Blast Radius）”的子任务协议。
2.  **定义标准化的“握手协议” (Handshake Protocol)：** 无论是“人交接给 Agent”还是“Agent 交接给 Agent”，都需要标准化的信息接口，而非单纯的一段 Prompt。协议必须包含：
    * **Goal:** 当前步骤的确切目标。
    * **Context:** 强相关的依赖信息（剔除噪声）。
    * **Constraints:** 绝对不能修改的文件或必须遵守的原则。
    * **Definition of Done (DoD):** 明确 Agent 如何自行判断任务已完成。
3.  **多模态验收与中间态反馈：** 针对“不到最后不验收”的工程顽疾，未来的框架必须**强制 Agent 在关键节点中断并抛出“确认请求（Approval Request）”**（例如：生成设计文档后、开始大量修改文件前）。这让人类 Entity 能够低成本地介入，进行方向校验。

基于不断的实践验证，工程界必将探索出更加包容且高效的人机开发新范式。